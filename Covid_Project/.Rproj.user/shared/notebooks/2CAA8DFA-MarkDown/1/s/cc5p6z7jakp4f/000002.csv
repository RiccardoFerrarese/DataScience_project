"0",""
"0","compute_prevalence_perc <- function(pop, cases){"
"0","  (cases/pop)*100"
"0","}"
"0",""
"0","## prevalenza su 1_000_000 di abitanti "
"0","compute_prevalence_abit <- function(pop, cases){"
"0","  (cases/pop)*1000000"
"0","}"
"0",""
"0","## passiamo alla funzioni i valori su cui fare il calcolo e la variabile per raggruppare i dati nel grafico "
"0","## facendo ciÃ² possiamo riutilizzare la funzione qualsiasi sia il dataset e la label dei dati "
"0",""
"0","## il dataset deve avere colonna popolazione e cases, inoltre la var di raggruppamento deve esser rinominata come ""group"" (per poter usar la funzione su dati di differente tipo)"
"0",""
"0","compute_and_visualize_prevalence <- function(dataset, plot=TRUE){"
"0","  "
"0","  dataset <- dataset %>% "
"0","    mutate( prev_perc = compute_prevalence_perc(popolazione, cases)) %>% "
"0","    mutate( prev_abt = compute_prevalence_abit(popolazione, cases)) %>% "
"0","    arrange( -prev_perc )"
"0",""
"0",""
"0","  if( plot ){"
"0","    ggplot( dataset, aes( x = popolazione, y = prev_perc, color = group ) ) + "
"0","      geom_point( size = 2, shape = 8 ) + "
"0","      geom_text(aes(label=group), hjust=0.5, vjust=1.4) +"
"0","      theme_minimal() + "
"0","      theme( legend.title = element_blank() )  + "
"0","      xlab(""popolazione"") + "
"0","      ylab(""prevalenza %"")"
"0","  }"
"0","  "
"0","}"
